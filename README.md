## GA for TSP

### 介绍
用遗传算法解决旅行商问题,参考[425776024/TSP-GA-py](https://github.com/425776024/TSP-GA-py)

### 软件架构
python3.9.0,ffmpeg

### 使用教程
运行main.py即可
````py
python main.py
````

参数分析等详细参见:[遗传算法解决TSP问题](https://www.cnblogs.com/Tenerome/articles/GATSP.html)
### 文档与示例

#### 旅行商问题

    也叫旅行推销员问题(Traveling salesman problem:TSP):给定一系列城市和每对城市之间的距离,求访问每座城市一次并回到起点城市的最短回路.它是组合优化中的一个`NP难问题` .

##### 解法思路

    途程构建法:从距离矩阵中产生一个近似最佳解的途径

    途程改善法:先给定一个可行的途程,然后进行改善,一直到不能改善为止

##### 经典解决算法

    枚举法(采用深度优先策略),回溯法,分支限界法(FIFO队列思想),贪心算法

##### 现代算法(启发式算法)

    遗传算法、模拟退火法、蚁群算法、禁忌搜索算法、贪婪算法和神经网络等

##### NP难问题

    NP:Non-deterministic Polynomial,多项式复杂程度的非确定性问题

    在算法中的一个衡量程序优劣的重要指标:复杂度,通常复杂度是一个多项式的最高量级

$P(n)=an^m+bn^{m-1}+cn^{m-2}...+dn+e+fn^{-1}+gn^{-2}+...$ 

$O(P(n))=n^m$

    若存在这样确定的多项式,那么就是一个P类问题(确定多项式)

    不存在的话,就是一个NP类问题.

    如最经典的TSP问题,如果用枚举法,对于n个城市求最短回路就需要(n-1)!次,就不是多项式了.

#### 遗传算法

    遗传算法(Genetic Algorithm,GA)是一种根据大自然中生物演化规律设计的.该算法通过数学的方式,利用计算机仿真运算,将问题的求解过程转换成类似生物进化中染色体基因交叉,变异等过程.

    在求解复杂的组合优化问题时,相对于一些常规的优化算法,通常能较快地获得较好得优化结果

##### 基本特征

###### 编码(基因,个体):gen

    由于遗传算法不能直接处理问题空间的参数,所以需要通过编码将要求解的问题表示成遗传空间的染色体.一个基因就是解决问题的一种解,一个种群,就是一组这样的解,遗传算法就是通过多代进化,淘汰得到最优解的过程

###### 适应度函数fitness

    适应度,表示某一个体对环境的适应能力,也表示该个体的繁殖能力,遗传算法的适应度函数也叫评价函数,是用来判断群体中的个体优劣程度的指标

    遗传算法在搜索进化过程中一般不需要其他外部信息，仅用评估函数来评估个体或解的优劣，并作为以后遗传操作的依据。由于遗传算法中，适应度函数要比较排序并在此基础上计算选择概率，所以适应度函数的值要取正值。由此可见，在不少场合，将目标函数映射成求最大值形式且函数值非负的适应度函数是必要的

###### 初始群体选取pop

    遗传算法中初始群体的个体选取是随机的,一般来讲，初始群体的设定可采取如下的策略: 
    a)根据问题固有知识，设法把握最优解所占空间在整个问题空间中的分布范围，然后，在此分布范围内设定初始群体
    b)先随机生成一定数目的个体，然后从中挑出最好的个体加到初始群体中。这种过程不断迭代，直到初始群体中个体数达到了预先确定的规模

##### 运算过程

###### (1)初始化

    设置最大进化代数T，随机生成M个个体作为初始群体P(0),并随机打乱(shuffle)顺序产生基因

###### (2)个体评价

    计算群体P(t)中各个个体的适应度,采用比值法(最短距离/)来定义每个基因的适应度

###### (3)选择运算(淘汰差的基因)

    将选择算子作用于群体。选择的目的是把优化的个体直接遗传到下一代或通过配对交叉产生新的个体再遗传到下一代。选择操作是建立在群体中个体的适应度评估基础上的

    本实验采用锦标赛算子算子,也就是优胜劣汰,适应度低于平均值的基因被淘汰(重组变异),特点是差的基因一定会被淘汰

    适应度函数用`最短距离/该基因的距离`表示

    *(ps:也使用过轮盘赌法,但是因为其随机性太大,导致无法收敛(只能到40000),已弃用)*

###### (4)交叉运算

    将交叉算子作用于群体。遗传算法中起核心作用的就是交叉算子

    本实验采用单点交叉算子,就是截取一段基因,嫁接到另一段

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133701683-1368458595.png)

###### (5)变异运算

    将变异算子作用于群体。即是对群体中的个体串的某些基因座上的基因值作变动

    本实验通过反转基因片段来实现变异


![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133702236-777140168.png)

###### (6)终止条件判断

    当t=T,则以进化过程中所得到的具有最大适应度个体作为最优解输出，终止计算。

p1len=index1时,就是迭代到22时,插入temp,后续接着插入

###### (7)收敛

    只要采样数足够大,运行时间足够长,理论上一定能找到最优解,但是现实中是难以达到的.所以本次实验认定最短距离低于20000时即收敛(实际实验中最小距离是19067:迭代10000代),即最大迭代10000次,若最短距离不能达到20000以下,则认为不能收敛


#### 结果示例
参数分析

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133702696-686774422.png)

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133703157-1684368219.png)

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133704084-195858016.png)

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133704632-869600904.png)

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133705184-780704412.png)

##### 主程序
收敛距离

![pic](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133705611-896190799.png)

过程曲线图

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133706056-1473367380.png)

动态化

![](https://img2022.cnblogs.com/blog/2629720/202210/2629720-20221022133706586-307628173.png)



